@echo off
chcp 65001 > nul
title –°–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ Reduxion Launcher

echo ========================================
echo    –°–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ Reduxion Launcher
echo ========================================
echo.

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤
echo [1/5] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤...
if not exist "installer.html" (
    echo ‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª installer.html –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    exit /b 1
)

if not exist "installer-styles.css" (
    echo ‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª installer-styles.css –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    exit /b 1
)

if not exist "installer-main.js" (
    echo ‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª installer-main.js –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    exit /b 1
)

if not exist "package-installer.json" (
    echo ‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª package-installer.json –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    exit /b 1
)

echo ‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã
echo.

REM –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞
echo [2/5] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞...
if not exist "installer-node_modules" (
    echo –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞...
    cd /d "%~dp0"
    call npm install --prefix . --save-dev electron-builder
    if errorlevel 1 (
        echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞!
        pause
        exit /b 1
    )
) else (
    echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
)

echo.
echo [3/5] –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞...

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ electron-builder
call npx electron-builder --version >nul 2>&1
if errorlevel 1 (
    echo –£—Å—Ç–∞–Ω–æ–≤–∫–∞ electron-builder –≥–ª–æ–±–∞–ª—å–Ω–æ...
    call npm install -g electron-builder
    if errorlevel 1 (
        echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ electron-builder!
        pause
        exit /b 1
    )
)

REM –°–æ–∑–¥–∞–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
if not exist "assets\icon.ico" (
    echo –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è SVG –∏–∫–æ–Ω–∫–∏ –≤ ICO —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞...
    echo –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
    echo.
)

echo ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
echo.

REM –°–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞
echo [4/5] –°–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞...
echo ========================================
echo.

echo üîß –°–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ –ª–∞—É–Ω—á–µ—Ä–∞...
echo –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç...
echo.

REM –°–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ —Å –ø–æ–º–æ—â—å—é electron-builder –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ package-installer.json
call npx electron-builder --config package-installer.json --win --publish=never
if errorlevel 1 (
    echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞!
    echo.
    echo –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
    echo - –û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ package-installer.json
    echo - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    echo - –û—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞
    echo.
    pause
    exit /b 1
)

echo.
echo [5/5] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–±–æ—Ä–∫–∏ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞...
echo ========================================
echo.

if exist "installer-dist" (
    echo ‚úÖ –°–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
    echo.
    echo –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ 'installer-dist':
    dir /b "installer-dist" 2>nul || echo –ü–∞–ø–∫–∞ –ø—É—Å—Ç–∞

    echo.
    echo üì¶ –ì–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞:
    if exist "installer-dist\*-Setup-*.exe" (
        echo ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫: installer-dist\*-Setup-*.exe
    )
    if exist "installer-dist\*-Portable-*.exe" (
        echo ‚úÖ –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫: installer-dist\*-Portable-*.exe
    )

    echo.
    echo ========================================
    echo   –°–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
    echo ========================================
    echo.
    echo üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
    echo 1. –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –∏–∑ –ø–∞–ø–∫–∏ 'installer-dist' —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
    echo 2. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ–Ω —Å–∫–∞—á–∏–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –ª–∞—É–Ω—á–µ—Ä–∞
    echo 3. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —è—Ä–ª—ã–∫–æ–≤
    echo.
    echo üéØ –ì–æ—Ç–æ–≤ –∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é!

) else (
    echo ‚ùå –ü–∞–ø–∫–∞ installer-dist –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ - —Å–±–æ—Ä–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å
    pause
    exit /b 1
)

echo.
pause