@echo off
chcp 65001 > nul
title –°–±–æ—Ä–∫–∞ Reduxion Launcher –≤ EXE

echo ========================================
echo    –°–±–æ—Ä–∫–∞ Reduxion Launcher –≤ EXE
echo ========================================
echo.

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤
echo [1/5] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤...
if not exist "modern-launcher.html" (
    echo ‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª modern-launcher.html –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    exit /b 1
)

if not exist "modern-styles.css" (
    echo ‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª modern-styles.css –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    exit /b 1
)

if not exist "assets\icon.svg" (
    echo ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –§–∞–π–ª –∏–∫–æ–Ω–∫–∏ assets/icon.svg –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo –°–æ–∑–¥–∞—é –±–∞–∑–æ–≤—É—é –∏–∫–æ–Ω–∫—É...
    echo.
)

echo ‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã
echo.

REM –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo [2/5] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
if not exist "node_modules" (
    echo –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ npm...
    call npm install
    if errorlevel 1 (
        echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π!
        pause
        exit /b 1
    )
) else (
    echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
)

echo.
echo [3/5] –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è —Å–±–æ—Ä–∫–∏...

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ electron-builder
call npx electron-builder --version >nul 2>&1
if errorlevel 1 (
    echo –£—Å—Ç–∞–Ω–æ–≤–∫–∞ electron-builder...
    call npm install electron-builder --save-dev
    if errorlevel 1 (
        echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ electron-builder!
        pause
        exit /b 1
    )
)

REM –°–æ–∑–¥–∞–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ ICO –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
if not exist "assets\icon.ico" (
    echo –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è SVG –∏–∫–æ–Ω–∫–∏ –≤ ICO —Ñ–æ—Ä–º–∞—Ç...
    echo –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
    echo –ü–æ–∫–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è SVG –∏–∫–æ–Ω–∫–∞
    echo.
)

echo ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
echo.

REM –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
echo [4/5] –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...
echo ========================================
echo.

echo üöÄ –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∫–∏ –ª–∞—É–Ω—á–µ—Ä–∞...
echo –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç...
echo.

REM –°–±–æ—Ä–∫–∞ —Å –ø–æ–º–æ—â—å—é electron-builder
call npx electron-builder --win --publish=never
if errorlevel 1 (
    echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –ª–∞—É–Ω—á–µ—Ä–∞!
    echo.
    echo –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
    echo - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    echo - –û—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    echo - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
    echo.
    pause
    exit /b 1
)

echo.
echo [5/5] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–±–æ—Ä–∫–∏...
echo ========================================
echo.

if exist "dist" (
    echo ‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
    echo.
    echo –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ 'dist':
    dir /b "dist" 2>nul || echo –ü–∞–ø–∫–∞ –ø—É—Å—Ç–∞

    echo.
    echo üì¶ –ì–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è:
    if exist "dist\*-Setup-*.exe" (
        echo ‚úÖ –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫: dist\*-Setup-*.exe
    )
    if exist "dist\*-Portable-*.exe" (
        echo ‚úÖ –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è: dist\*-Portable-*.exe
    )

    echo.
    echo ========================================
    echo   –°–±–æ—Ä–∫–∞ –ª–∞—É–Ω—á–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
    echo ========================================
    echo.
    echo üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
    echo 1. –î–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ 'dist'
    echo 2. –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ (*.exe) - –¥–ª—è –ø–æ–ª–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å —è—Ä–ª—ã–∫–∞–º–∏
    echo 3. –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è (*.exe) - –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    echo.
    echo üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

) else (
    echo ‚ùå –ü–∞–ø–∫–∞ dist –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ - —Å–±–æ—Ä–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å
    pause
    exit /b 1
)

echo.
pause